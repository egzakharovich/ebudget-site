# Проверка работоспособности ГОСТ TLS

## Используя Портал заявителя УЦ ФК (КР)

Откройте выбранный вами браузер ГОСТ TLS.

Перейдите по ссылке `https://fzs.roskazna.ru/`

Должен открыться Портал заявителя УЦ ФК (КР).

<!-- tabs:start -->

### __Chromium GOST__

![](../../assets/images/5_test-gost-tls_2022-07-14-12-40-00.png)

### __Яндекс.Браузер__

![](../../assets/images/5_test-gost-tls_2022-07-15-09-38-44.png)

<!-- tabs:end -->

Это означает успешную установку соединения TLS с применением алгоритмов ГОСТ с односторонней аутентификацией (анонимный TLS) через криптопровайдер.

В том числе, это можно понять, просмотрев параметры безопасности соединения. И свойства сертификата сервера.

<!-- tabs:start -->

### __Chromium GOST__

![](../../assets/images/5_test-gost-tls_2022-07-15-09-52-22.png) ![](../../assets/images/5_test-gost-tls_2022-07-15-09-50-52.png) ![](../../assets/images/5_test-gost-tls_2022-07-15-09-49-13.png)

### __Яндекс.Браузер__

![](../../assets/images/5_test-gost-tls_2022-07-15-09-45-29.png) ![](../../assets/images/5_test-gost-tls_2022-07-15-09-46-00.png) ![](../../assets/images/5_test-gost-tls_2022-07-15-09-49-13.png)

<!-- tabs:end -->

Нажмите на `Войти по сертификату` и выберите свой личный сертификат.

<!-- tabs:start -->

### __Chromium GOST__

![](../../assets/images/5_test-gost-tls_2022-07-14-12-43-04.png)

### __Яндекс.Браузер__

![](../../assets/images/5_test-gost-tls_2022-07-15-09-43-29.png)

<!-- tabs:end -->

В случае успешного входа, откроется личный кабинет. В углу появится ФИО.

Это означает уже успешный вход с применением двухсторонней аутентификации, с передачей информации о сертификате пользователя.

<!-- tabs:start -->

### __Chromium GOST__

![](../../assets/images/5_test-gost-tls_2022-07-14-12-45-24.png)

### __Яндекс.Браузер__

![](../../assets/images/5_test-gost-tls_2022-07-15-09-54-45.png)

<!-- tabs:end -->

Портал обязательно выдаст ошибку, если вы используете сертификат выданный другим удостоверяющим центром и вернёт вас на fzs.roskazna.ru, где сообщит вам об этом в модальном окне на веб-странице. Но это тоже можно принять за успех, т.к. данные о сертификате были переданы и вас &laquo;успешно отсеяли&raquo;.

## Альтернативный тест с двухсторонней аутентификацией

У компании КриптоПро есть ресурс с тестовой страницей, позволяющий проверить ГОСТ TLS с двухсторонней аутентификацией. В том числе, на нём можно проверить сертификаты, выпущенные УЦ отличными от ФК (КР).

Ресурс располагается по адресу: <https://www.cryptopro.ru:4444/test/tls-cli.asp>

<!-- tabs:start -->

### __Chromium GOST__

![](../../assets/images/5_test-gost-tls_2022-07-15-10-12-27.png)

![](../../assets/images/5_test-gost-tls_2022-07-15-10-13-50.png)

### __Яндекс.Браузер__

![](../../assets/images/5_test-gost-tls_2022-07-15-10-15-54.png)

![](../../assets/images/5_test-gost-tls_2022-07-15-10-16-41.png)

<!-- tabs:end -->

## Общие рекомендации по работе с ресурсами ГОСТ TLS

Для входа на любой ресурс, защищённый с помощью ГОСТ, обязательно указывайте в адресе URL протокол HTTPS. В закладках тоже. Например:

`https://eb.cert.roskazna.ru/`

Если указать только домен, то браузер может автоматически преобразовать адрес не в HTTPS, а в HTTP.

`HTTP://eb.cert.roskazna.ru/`

Что неправильно. Т.к. TLS по умолчанию подразумевает HTTPS.

И в то же время, это является проблемой, потому что на ресурсах ГИИС ЭБ, на точке доступа, администраторы, во время DDoS атак, приняли решение игнорировать подключения на 80-ом порту (HTTP). Раньше соединения явным образом отклонялись.

Что вызывает следующую картину:

<!-- tabs:start -->

### __Chromium GOST__

![](../../assets/images/5_test-gost-tls_2022-07-15-10-30-05.png)

### __Яндекс.Браузер__

![](../../assets/images/5_test-gost-tls_2022-07-15-10-30-14.png)

<!-- tabs:end -->

Это не означает, что Портал ФК &laquo;лежит&raquo;. Просто ссылка указывает на не тот протокол.

Обычно принято использовать [механизм HSTS](https://ru.wikipedia.org/wiki/HSTS) для того, чтобы сообщить браузеру, что нужно использовать HTTPS. Но ГИИС ЭБ оказался исключением... ¯\\\_(ツ)\_/¯

Так же, чтобы такого не случалось, можно вручную прописать политику HSTS в браузере, на сервисной странице по адресу `about://net-internals#HSTS`

<!-- tabs:start -->

### __Chromium GOST__

![](../../assets/common-images/Browser/ChromiumGOST/Browser-ChromiumGOST-Add_HSTS_by_hand-Step_1.png)

![](../../assets/common-images/Browser/ChromiumGOST/Browser-ChromiumGOST-Add_HSTS_by_hand-Step_2.png)

### __Яндекс.Браузер__

![](../../assets/common-images/Browser/Yandex.Browser/Browser-Yandex.Browser-Add_HSTS_by_hand-Step_1.png)

![](../../assets/common-images/Browser/Yandex.Browser/Browser-Yandex.Browser-Add_HSTS_by_hand-Step_2.png)

<!-- tabs:end -->

<!-- // code: language=markdown insertSpaces=true tabSize=2 -->
